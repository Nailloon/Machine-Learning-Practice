Сохранение моделей на диск
Мы можем сохранить модели после обучения, чтобы использовать их в дальнейшем (возможно, в других приложениях) для
получения предсказаний. Для сохранения моделей sklearn рекомендуется использовать стандартный пакет pickle.

[ ] 1 импортируем пакет для сохранения / загрузки python объектов на диск
2 import pickle
[ ] 1# для примера сохраним на диск модель градиентного бустинга для классификации (обучена выше)
2 pickle.dump(gb, open('/content/drive/MyDrive/models/gradient_boosting.sav", 'wb'))


Модель сохранена на Google Drive и находится в папке models. Давайте теперь загрузим ее (в новую переменную) и попробуем
вычислить метрики. Вычисление метрик требует получения предсказаний методом predict, поэтому мы увидим, что модель
загрузилась и все так же отлично может предсказывать классы. Для регрессии все будет аналогично.

gb_restored = pickle.load(open("/content/drive/HyDrive/models/gradient_boosting.sav', 'rb'))
print(classification_report(y_test, gb_restored.predict(X_test)))
print(confusion_matrix(y_test, gb_restored.predict(X_test)))
